.ORG 00000H
	LXI SP,0FFFFH
	MVI A,08AH
	OUT 09FH
	MVI A,000H
	STA 09000H
	MVI A,001H
	STA 09002H
	LXI H,08000H
	SHLD 09004H
	MVI A,000H
	STA 09100H
	JMP START
.ORG 0003CH
	IN 09DH
	STA 09008H
	JMP SERVICE
.ORG 01000H
START:	CALL LCD_INIT
	CALL PRINT_START
START2:	XRA A
	IN 09EH
	ANI 080H
	RAL
	JNC START2
	EI
	MVI A,00BH
	SIM
BEGIN:	LXI SP,0FFFFH
	CALL LCD_INIT
	CALL HEX2BCD
	CALL PRINT_SCORE
	LDA 09000H
	ANI 00FH
	CPI 000H
	JZ L1
	CPI 001H
	JZ L2
	CPI 002H
	JZ L3
	CPI 003H
	JZ L4
	CPI 004H
	JZ L5
	CPI 005H
	JZ L6
	JMP START2
L1:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP1_1:	MVI A,001H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP1_2:	MVI A,001H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP1_3:	MVI A,001H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP1_4:	MVI A,001H
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP1_5:	MVI A,001H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP1_6:	MVI A,040H
	OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP1_6
	JMP END

L2:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP2_1:	MVI A,002H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP2_2:	MVI A,002H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP2_3:	MVI A,002H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP2_4:	MVI A,002H
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP2_5:	MVI A,002H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP2_6:	MVI A,080H
	OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP2_6
	JMP END

L3:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP3_1:	MVI A,004H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP3_2:	MVI A,004H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP3_3:	MVI A,004H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP3_4:	MVI A,004H
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP3_5:	MVI A,004H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP3_6:	MVI A,040H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP3_6
	JMP END

L4:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP4_1:	MVI A,008H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP4_2:	MVI A,008H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP4_3:	MVI A,008H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP4_4:	MVI A,008H
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP4_5:	MVI A,008H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP4_6:	MVI A,080H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP4_6
	JMP END

L5:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP5_1:	MVI A,010H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP5_2:	MVI A,010H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP5_3:	MVI A,010H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP5_4:	MVI A,010H
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP5_5:	MVI A,010H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP5_6:	MVI A,040H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP5_6
	JMP END

L6:	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP6_1:	MVI A,020H
			OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_1
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP6_2:	MVI A,020H
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_2
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP6_3:	MVI A,020H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_3
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP6_4:	MVI A,020H
	OUT 0CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_4
	LHLD 09004H
	MOV B,H
	MOV C,L
LOOP6_5:	MVI A,020H
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_5
	LHLD 09004H
	MOV B,H
	MOV C,L
	DI
LOOP6_6:	MVI A,080H
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP6_6
	JMP END

END:	MVI E,00AH
	CALL LCD_INIT
	CALL PRINT_OVER
REP:	LXI B,05000H
LOOPEND1:	MVI A,0FFH
	OUT 000H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOPEND1
	LXI B,05000H
LOOPEND2:	MVI A,0FFH
	OUT 004H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOPEND2
	LXI B,05000H
LOOPEND3:	MVI A,0FFH
	OUT 008H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOPEND3
	LXI B,05000H
LOOPEND4:	MVI A,0FFH
	OUT 00CH
	DCX B
	MOV A,C
	ORA B
	JNZ LOOPEND4
	LXI B,05000H
LOOPEND5:	MVI A,0FFH
	OUT 010H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOPEND5
	DCR E
	JNZ REP
	HLT

SERVICE:	LDA 09008H
	ANI 03FH
	RAR
	JC COL1
	RAR
	JC COL2
	RAR
	JC COL3
	RAR
	JC COL4
	RAR
	JC COL5
	RAR
	JC COL6
	EI
	JMP BEGIN
COL1:	LDA 09000H
	CPI 000H
	JZ TRUE
	JMP END
COL2:	LDA 09000H
	CPI 001H
	JZ TRUE
	JMP END
COL3:	LDA 09000H
	CPI 002H
	JZ TRUE
	JMP END
COL4:	LDA 09000H
	CPI 003H
	JZ TRUE
	JMP END
COL5:	LDA 09000H
	CPI 004H
	JZ TRUE
	JMP END
COL6:	LDA 09000H
	CPI 005H
	JZ TRUE
	JMP END
TRUE:	LHLD 09004H
	LXI B,00500H
LOOP_DECR:	DCX H
	DCX B
	MOV A,C
	ORA B
	JNZ LOOP_DECR
	SHLD 09004H
	LXI H,09002H
	INR M
	LDA 09000H
	CPI 000H
	JZ RN1
	CPI 004H
	JZ RN2
	CPI 001H
	JZ RN3
	CPI 005H
	JZ RN4
	CPI 002H
	JZ RN5
	CPI 003H
	JZ RN6
RN1:	MVI A,004H
	STA 09000H
	EI
	JMP BEGIN
RN2:	MVI A,001H
	STA 09000H
	EI
	JMP BEGIN
RN3:	MVI A,005H
	STA 09000H
	EI
	JMP BEGIN
RN4:	MVI A,002H
	STA 09000H
	EI
	JMP BEGIN
RN5:	MVI A,003H
	STA 09000H
	EI
	JMP BEGIN
RN6:	MVI A,000H
	STA 09000H
	EI
	JMP BEGIN

PRINT_SCORE:  PUSH H
	      PUSH B
	      LXI H,09100H
	      MOV A,M
	      LXI H,02000H
	      ANI 0F0H
	      RRC
	      RRC
	      RRC
	      RRC
	      ADD L
	      MOV L,A
	      MOV A,M
	      OUT 09CH
	      MVI A,003H	
	      OUT 09EH
	      MVI A,002H	
	      OUT 09EH
	      MVI B,002H
	      CALL DELAY
	      LXI H,09100H
	      MOV A,M
	      LXI H,02000H
	      ANI 00FH
	      ADD L
	      MOV L,A
	      MOV A,M
	      OUT 09CH
	      MVI A,003H	
	      OUT 09EH
	      MVI A,002H
	      OUT 09EH
	      MVI B,002H
	      CALL DELAY
	      POP B
	      POP H
	      RET
HEX2BCD:
         PUSH PSW
         PUSH B
         PUSH D
         MVI D,000H          ;Clear D- reg for Most significant Byte 
         XRA A             ;Clear Accumulator 
         LXI H,09002H
         MOV C,M         ; GET HEX SCORE

LOOPBCD2: ADI 001H              ;Count the number one by one 
         DAA                               ;Adjust for BCD count 
         JNC LOOPBCD1 
         INR D 
LOOPBCD1: DCR C 
         JNZ LOOPBCD2
	STA 09100H 
	POP D
	POP B
	POP PSW
	RET

DELAY:	   DCR B	
	   JNZ DELAY
	   RET
LCD_INIT:	MVI D,030H
	   CALL SEND_CMND
	   MVI D,00CH	
	   CALL SEND_CMND
	   MVI D,006H	
	   CALL SEND_CMND
	   MVI D,001H
	   CALL SEND_CMND
	   MVI D,002H
	   CALL SEND_CMND
	   RET

SEND_CMND:	MOV A,D	
	   OUT 09CH
	   MVI A,001H
	   OUT 09EH
	   XRA A
	   OUT 09EH
	   MVI B,0FFH
	   CALL DELAY
	   RET
PRINT_OVER:   PUSH H
	      PUSH B
	      LXI H,02200H
	      MVI C,00AH
	      CALL PRINTLOOP
	      POP B
	      POP H
	      RET
PRINT_START:   PUSH H
	      PUSH B
	      LXI H,02300H
	      MVI C,00EH
	      CALL PRINTLOOP
	      POP B
	      POP H
	      RET
PRINTLOOP:	MOV A,M
	   OUT 09CH
	   MVI A,003H
	   OUT 09EH
	   MVI A,002H
	   OUT 09EH
	   MVI B,002H
	   CALL DELAY
	   INX H
	   DCR C
	   JNZ PRINTLOOP
	   RET
.ORG 02000H
.DB 030H,031H,032H,033H,034H,035H,036H,037H,038H,039H 
.ORG 02200H
.DB 047H,061H,06DH,065H,020H,06FH,076H,065H,072H,021H
.ORG 02300H
.DB 04BH,069H,06CH,06CH,02DH,074H,068H,065H,02DH,056H,069H,072H,075H,073H,021H
